inputs -> df.
communication -> np.array
return -> np.array